import{$ as ye,H as fe,I as z,J as P,L as Ke,M as We,N as Ye,O as $e,P as Zt,Q as Ht,R as Qe,S as Ze,T as He,U as $,V as Je,W as Xe,X as Jt,Y as Xt,Z as et,_ as ve,a as qe,b as Ue,d as ze,e as Ge,y as W,z as Y}from"./chunk-WFKKPNLG.js";import{G as $t,K,O as I,Q as he,R as Qt,S as ee,U as h,X as A,Y as V,_ as y,aa as L,ca as j,da as je,ea as B,fa as Be,g as E,ha as q,ja as U,l as Kt,m as dt,u as Wt,v as Yt,x as N,y as R}from"./chunk-5BM7LAKC.js";import{$ as xe,$a as _,Ac as X,Ba as De,Cb as de,D as Fe,Db as Le,Dc as Gt,Eb as Nt,F as ct,Fa as Mt,Ga as x,I as T,Ka as m,Lb as Rt,Ma as Ne,Mb as At,Oa as It,P as mt,Pa as M,R as Ee,T as Ct,U as bt,Ua as a,Va as s,Vb as Vt,W as xt,Wa as g,Wb as Lt,X as oe,Xa as Re,Y as te,Ya as Ae,Yb as jt,Za as kt,Zb as Bt,_ as Q,_a as D,a as H,aa as Pt,ab as v,ba as O,bc as ue,ca as ie,da as St,f as st,fb as Ft,fc as qt,gb as Ve,hb as ae,ia as C,ib as se,j as vt,ja as b,jc as Ut,k as lt,kb as u,l as yt,lb as J,m as _t,ma as Ot,mb as Et,na as Te,oa as ne,pb as le,q as ke,qb as ce,rb as me,s as wt,sb as Tt,t as be,tb as F,ub as f,va as l,vb as w,wa as d,wb as k,xb as Dt,xc as pe,yc as zt,zc as ge}from"./chunk-N2EQA6T4.js";var ut=class{constructor(){}loadScript(i,r,e,t=null){if(typeof document<"u"&&!document.getElementById(i)){let n=document.createElement("script");n.async=!0,n.src=r,n.onload=e,t||(t=document.head),t.appendChild(n)}}},pt=class{},fi={oneTapEnabled:!0},_e=(()=>{let i=class i extends ut{constructor(e,t){super(),this.clientId=e,this.initOptions=t,this.changeUser=new ne,this._socialUser=new lt(null),this._accessToken=new lt(null),this._receivedAccessToken=new ne,this.initOptions=H(H({},fi),this.initOptions),this._socialUser.pipe(mt(1)).subscribe(this.changeUser),this._accessToken.pipe(mt(1)).subscribe(this._receivedAccessToken)}initialize(e){return new Promise((t,n)=>{try{this.loadScript(i.PROVIDER_ID,"https://accounts.google.com/gsi/client",()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:e,callback:({credential:c})=>{let p=this.createSocialUser(c);this._socialUser.next(p)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe(Fe(c=>c===null)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){let c=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(p=>p).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:c,prompt:this.initOptions.prompt,callback:p=>{p.error?this._accessToken.error({code:p.error,description:p.error_description,uri:p.error_uri}):this._accessToken.next(p.access_token)}})}t()})}catch(c){n(c)}})}getLoginStatus(){return new Promise((e,t)=>{this._socialUser.value?e(this._socialUser.value):t(`No user is currently logged in with ${i.PROVIDER_ID}`)})}refreshToken(){return new Promise((e,t)=>{google.accounts.id.revoke(this._socialUser.value.id,n=>{n.error?t(n.error):e(this._socialUser.value)})})}getAccessToken(){return new Promise((e,t)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe(T(1)).subscribe(e)):this._socialUser.value?t("No token client was instantiated, you should specify some scopes."):t("You should be logged-in first.")})}revokeAccessToken(){return new Promise((e,t)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),e()}):t("No access token to revoke"):t("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){return st(this,null,function*(){google.accounts.id.disableAutoSelect(),this._socialUser.next(null)})}createSocialUser(e){let t=new pt;t.idToken=e;let n=this.decodeJwt(e);return t.id=n.sub,t.name=n.name,t.email=n.email,t.photoUrl=n.picture,t.firstName=n.given_name,t.lastName=n.family_name,t}decodeJwt(e){let n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),c=decodeURIComponent(window.atob(n).split("").map(function(p){return"%"+("00"+p.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(c)}};i.PROVIDER_ID="GOOGLE";let o=i;return o})(),Pe=(()=>{let i=class i{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(e,t,n){this._ngZone=t,this._injector=n,this.providers=new Map,this.autoLogin=!1,this._user=null,this._authState=new yt(1),this.initialized=!1,this._initState=new _t,e instanceof Promise?e.then(c=>{this.initialize(c)}):this.initialize(e)}initialize(e){this.autoLogin=e.autoLogin!==void 0?e.autoLogin:!1;let{onError:t=console.error}=e;e.providers.forEach(n=>{this.providers.set(n.id,"prototype"in n.provider?this._injector.get(n.provider):n.provider)}),Promise.all(Array.from(this.providers.values()).map(n=>n.initialize(this.autoLogin))).then(()=>{if(this.autoLogin){let n=[],c=!1;this.providers.forEach((p,S)=>{let Z=p.getLoginStatus();n.push(Z),Z.then(Ce=>{this.setUser(Ce,S),c=!0}).catch(console.debug)}),Promise.all(n).catch(()=>{c||(this._user=null,this._authState.next(null))})}this.providers.forEach((n,c)=>{wt(n.changeUser)&&n.changeUser.subscribe(p=>{this._ngZone.run(()=>{this.setUser(p,c)})})})}).catch(n=>{t(n)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(e){return st(this,null,function*(){let t=this.providers.get(e);if(this.initialized)if(t){if(!(t instanceof _e))throw i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN}else throw i.ERR_LOGIN_PROVIDER_NOT_FOUND;else throw i.ERR_NOT_INITIALIZED;return yield t.getAccessToken()})}refreshAuthToken(e){return new Promise((t,n)=>{if(!this.initialized)n(i.ERR_NOT_INITIALIZED);else{let c=this.providers.get(e);c?typeof c.refreshToken!="function"?n(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):c.refreshToken().then(p=>{this.setUser(p,e),t()}).catch(p=>{n(p)}):n(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}refreshAccessToken(e){return new Promise((t,n)=>{if(!this.initialized)n(i.ERR_NOT_INITIALIZED);else if(e!==_e.PROVIDER_ID)n(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{let c=this.providers.get(e);c instanceof _e?c.revokeAccessToken().then(t).catch(n):n(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}signIn(e,t){return new Promise((n,c)=>{if(!this.initialized)c(i.ERR_NOT_INITIALIZED);else{let p=this.providers.get(e);p?p.signIn(t).then(S=>{this.setUser(S,e),n(S)}).catch(S=>{c(S)}):c(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}signOut(e=!1){return new Promise((t,n)=>{if(!this.initialized)n(i.ERR_NOT_INITIALIZED);else if(!this._user)n(i.ERR_NOT_LOGGED_IN);else{let c=this._user.provider,p=this.providers.get(c);p?p.signOut(e).then(()=>{t(),this.setUser(null)}).catch(S=>{n(S)}):n(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}setUser(e,t){e&&t&&(e.provider=t),this._user=e,this._authState.next(e)}};i.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",i.ERR_NOT_LOGGED_IN="Not logged in",i.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",i.\u0275fac=function(t){return new(t||i)(Q("SocialAuthServiceConfig"),Q(De),Q(Ot))},i.\u0275prov=oe({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})(),ei=(()=>{let i=class i{static initialize(e){return{ngModule:i,providers:[Pe,{provide:"SocialAuthServiceConfig",useValue:e}]}}constructor(e){if(e)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}};i.\u0275fac=function(t){return new(t||i)(Q(i,12))},i.\u0275mod=ie({type:i}),i.\u0275inj=te({providers:[Pe],imports:[ue]});let o=i;return o})();var tt=(()=>{let i=class i{constructor(e,t){this.type="icon",this.size="medium",this.text="signin_with",this.shape="rectangular",this.theme="outline",this.logo_alignment="left",this.width=0,this.locale="",t.initState.pipe(T(1)).subscribe(()=>{Promise.resolve(this.width).then(n=>{n>400||n<200&&n!=0?Promise.reject("Please note .. max-width 400 , min-width 200 (https://developers.google.com/identity/gsi/web/tools/configurator)"):google.accounts.id.renderButton(e.nativeElement,{type:this.type,size:this.size,text:this.text,width:this.width,shape:this.shape,theme:this.theme,logo_alignment:this.logo_alignment,locale:this.locale})})})}};i.\u0275fac=function(t){return new(t||i)(d(Te),d(Pe))},i.\u0275dir=St({type:i,selectors:[["asl-google-signin-button"]],inputs:{type:"type",size:"size",text:"text",shape:"shape",theme:"theme",logo_alignment:"logo_alignment",width:"width",locale:"locale"}});let o=i;return o})(),it=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ie({type:i}),i.\u0275inj=te({});let o=i;return o})();var yi=()=>({validation:"required",message:"an email is required"}),_i=()=>({validation:"email",message:"please enter a valid email"}),ti=(o,i)=>[o,i],wi=()=>({validation:"required",message:"a password is required"}),Ci=()=>["pattern","minlength","maxlength"],bi=o=>({validation:o,message:"a password must be at least 8 characters long, and contain at least one lowercase letter, one uppercase letter, and one special character."}),ni=(()=>{let i=class i{constructor(e,t,n,c,p,S){this.authenticationService=e,this.navigation=t,this.formBuilder=n,this.element=c,this.message=p,this.zone=S,this.submissionLoading=!1}ngOnInit(){this.loginForm=this.formBuilder.group({email:new y(null,{validators:[h.required,h.email],updateOn:"blur"}),password:new y(null,{validators:[h.required,h.minLength(8),h.pattern(K.passwordPattern)],updateOn:"blur"})})}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.patchValueFromNativeElement("email","#email"),this.patchValueFromNativeElement("password","#password")})},500)})}patchValueFromNativeElement(e,t){let n=this.element.nativeElement.querySelector(t);n?.value&&this.loginForm.get(e)?.patchValue(n.value)}dd24Login(){if(this.loginForm.invalid){P.markAllAsDirty(this.loginForm);return}this.submissionLoading=!0,this.authenticationService.login(this.loginForm.value,{next:this.onLoginSuccess.bind(this),error:this.onLoginError.bind(this)})}onLoginSuccess(){this.navigation.navigateToRouteBeforeRedirection()}onLoginError(e){this.submissionLoading=!1,e.error.status>=500?this.displayError("Server error","Please try again later"):e.error.status>=400?this.displayError("Incorrect email or password","Please try again"):e.error.status===0?this.displayError("Network error","Check your connection and try again"):this.displayError("An error occurred","Please try again")}displayError(e,t){this.message.add({severity:"error",summary:e,detail:t})}};i.\u0275fac=function(t){return new(t||i)(d(I),d($),d(q),d(Te),d(E),d(De))},i.\u0275cmp=O({type:i,selectors:[["dd24-login-page"]],standalone:!0,features:[F],decls:24,vars:18,consts:[[1,"form-card","dd24-auth-form"],["routerLink","../register",1,"registration-link","link"],[1,"google-login"],["type","standard","size","large","text","continue_with","locale","en",1,"google-signin-button",3,"width"],["align","center",1,"divider"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"inputs"],[1,"input","email-input"],["for","email"],["controlName","email",3,"errorMessages"],["type","email","pInputText","","formControlName","email","name","email","placeholder","Your email","id","email",1,"p-fluid"],[1,"input","password-input"],["for","password"],["controlName","password",3,"errorMessages"],["type","password","formControlName","password","name","password","toggleMask","true","placeholder","Your password","inputId","password",1,"p-fluid",3,"feedback"],["routerLink","../forgot-password",1,"link","forgot-password"],["label","Login","type","submit",1,"login-submit",3,"loading"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"h1"),u(2,"Log into DietiDeals24"),s(),a(3,"a",1),u(4," you don't have an account? "),s(),a(5,"div",2),g(6,"asl-google-signin-button",3),s(),a(7,"p-divider",4),u(8,"or"),s(),a(9,"form",5),_("ngSubmit",function(){return n.dd24Login()}),a(10,"section",6)(11,"div",7)(12,"label",8),u(13,"Email"),s(),a(14,"dd24-input",9),g(15,"input",10),s()(),a(16,"div",11)(17,"label",12),u(18,"Password"),s(),a(19,"dd24-input",13),g(20,"p-password",14),s()()(),a(21,"a",15),u(22," forgot your password? "),s(),g(23,"p-button",16),s()()),t&2&&(l(6),m("width",300),l(3),m("formGroup",n.loginForm),l(5),m("errorMessages",k(8,ti,f(6,yi),f(7,_i))),l(5),m("errorMessages",k(15,ti,f(11,wi),w(13,bi,f(12,Ci)))),l(),m("feedback",!1),l(3),m("loading",n.submissionLoading))},dependencies:[U,L,ee,A,V,j,B,X,z,Y,W,R,N,ye,ve,Ue,qe,it,tt],styles:[".form-card[_ngcontent-%COMP%]   .google-login[_ngcontent-%COMP%]{margin-top:1rem;width:100%;padding-left:3rem;padding-right:3rem;min-height:44px;display:flex;justify-content:center}.form-card[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%}.form-card[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:0;flex-wrap:nowrap;padding-left:3rem;padding-right:3rem;font-size:var(--font-size-medium);width:100%}.form-card[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:1em;flex-wrap:nowrap}.form-card[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:0;flex-wrap:nowrap}.form-card[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]{margin-top:.25rem}.form-card[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{align-self:center;margin-bottom:1rem;word-wrap:break-word}.form-card[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-submit[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .p-divider-content{font-weight:var(--font-weight-bolder);color:var(--text-color-3)}"]});let o=i;return o})();var Fi=()=>({validation:"required",message:"a name is required"}),Me=o=>[o],Ei=()=>({validation:"required",message:"a surname is required"}),Ti=()=>({validation:"required",message:"a birthday is required"}),Di=()=>({validation:"required",message:"a country is required"}),Ni=()=>({customValidation:"noCountrySelected",message:"You must select a country before selecting a city"}),Ri=()=>({validation:"required",message:"a city is required"}),ot=(o,i)=>[o,i],Ai=()=>({validation:"required",message:"an email is required"}),Vi=()=>({validation:"email",message:"Please enter a valid email"}),Li=()=>({validation:"required",message:"an username is required"}),ji=()=>({validation:"required",message:"a password is required"}),Bi=()=>["pattern","minlength","maxlength"],qi=o=>({validation:o,message:"a password must be at least 8 characters long, and contain at least one lowercase letter, one uppercase letter, and one special character."}),Ui=()=>({validation:"required",message:"you need to confirm your password"}),zi=()=>({customValidation:"passwordsDoNotMatch",message:"passwords do not match"});function Gi(o,i){if(o&1){let r=D();a(0,"div",7)(1,"div",13)(2,"label",14),u(3,"Name*"),s(),a(4,"dd24-input",15),g(5,"input",16),s()(),a(6,"div",13)(7,"label",17),u(8,"Surname*"),s(),a(9,"dd24-input",18),g(10,"input",19),s()(),a(11,"div",13)(12,"label",20),u(13,"Birthday*"),s(),a(14,"dd24-input",21),g(15,"p-calendar",22),s()(),a(16,"div",13)(17,"label",23),u(18,"Country*"),s(),a(19,"dd24-input",24)(20,"p-autoComplete",25),_("completeMethod",function(t){C(r);let n=v();return b(n.completeCountries(t))}),s()()(),a(21,"div",13)(22,"label",26),u(23,"City*"),s(),a(24,"dd24-input",27)(25,"p-autoComplete",28),_("completeMethod",function(t){C(r);let n=v();return b(n.completeCities(t))}),s()()()()}if(o&2){let r=v();l(4),m("errorMessages",w(18,Me,f(17,Fi))),l(),m("pKeyFilter",r.environment.alphaAndWhiteSpacePattern),l(4),m("errorMessages",w(21,Me,f(20,Ei))),l(),m("pKeyFilter",r.environment.alphaAndWhiteSpacePattern),l(4),m("errorMessages",w(24,Me,f(23,Ti))),l(),m("showIcon",!0)("minDate",r.minBirthdayDate)("maxDate",r.maxBirthdayDate)("defaultDate",r.defaultBirthdayDate),l(4),m("errorMessages",w(27,Me,f(26,Di))),l(),m("suggestions",r.filteredCountries)("pKeyFilter",r.environment.alphaAndWhiteSpacePattern),l(2),Ne("p-disabled",r.registrationForm.controls.userData.controls.city.disabled),l(2),m("errorMessages",k(31,ot,f(29,Ni),f(30,Ri))),l(),m("suggestions",r.filteredCities)("pKeyFilter",r.environment.alphaAndWhiteSpacePattern)}}function Ki(o,i){if(o&1&&(a(0,"div",8)(1,"div",13)(2,"label",29),u(3,"Email*"),s(),a(4,"dd24-input",30),g(5,"input",31),s()(),a(6,"div",13)(7,"label",32),u(8,"Username*"),s(),a(9,"dd24-input",33),g(10,"input",34),s()(),a(11,"div",13)(12,"label",35),u(13,"Password*"),s(),a(14,"dd24-input",36),g(15,"p-password",37),s()(),a(16,"div",13)(17,"label",38),u(18,"Confirm password*"),s(),a(19,"dd24-input",39),g(20,"p-password",40),s()()()),o&2){let r=v();l(4),m("errorMessages",k(11,ot,f(9,Ai),f(10,Vi))),l(5),m("errorMessages",w(15,Me,f(14,Li))),l(),m("maxlength",r.environment.usernameMaxLength),l(4),m("errorMessages",k(21,ot,f(17,ji),w(19,qi,f(18,Bi)))),l(),m("feedback",!0)("strongRegex",r.environment.passwordStrongPattern)("mediumRegex",r.environment.passwordMediumPattern),l(4),m("errorMessages",k(26,ot,f(24,Ui),f(25,zi))),l(),m("feedback",!1)}}function Wi(o,i){if(o&1){let r=D();a(0,"div",9)(1,"div",41),_("click",function(t){C(r);let n=v();return b(n.setDialogVisibility(t))})("keypress",function(t){C(r);let n=v();return b(n.setDialogVisibility(t))}),g(2,"div",42),a(3,"div",43)(4,"span"),u(5,"Terms of Service"),s(),g(6,"i",44),s(),a(7,"span"),u(8),s()(),a(9,"div",45),g(10,"p-checkbox",46),a(11,"label",47),u(12,"I have read and accept the terms of the above terms of service"),s()()()}if(o&2){let r=v();l(8),J(r.tos)}}function Yi(o,i){if(o&1&&(a(0,"span",10),u(1),s()),o&2){let r=v();l(),J(r.error)}}var oi=(()=>{let i=class i{get environment(){return K}constructor(e,t,n,c,p,S,Z,Ce){this.formBuilder=e,this.locationsService=t,this.router=n,this.authentication=c,this.message=p,this.assets=S,this.navigation=Z,this.windowService=Ce,this.subscriptions=[],this.next$=new vt,this.activeStep=0,this.error="",this.countries=[],this.filteredCountries=[],this.cities=[],this.filteredCities=[],this.minBirthdayDate=new Date(1900,0,1),this.maxBirthdayDate=new Date,this.defaultBirthdayDate=new Date(2e3,0,1),this.privacyPolicyDialogVisible=!1,this.tos="",this.onNextuserData=()=>this.registrationForm.get("userData")?.valid?!0:(P.markAllAsDirty(this.registrationForm.get("userData")),!1),this.onNextCredentials=()=>this.registrationForm.get("credentials")?.valid?!0:(P.markAllAsDirty(this.registrationForm.get("credentials")),!1),this.steps=[{title:"Your data",nextCallback:this.onNextuserData.bind(this)},{title:"Your credentials",nextCallback:this.onNextCredentials.bind(this)},{title:"Privacy policy"}],this.submissionLoading=!1}ngOnInit(){this.initForm(),this.maxBirthdayDate.setFullYear(this.maxBirthdayDate.getFullYear()-18),this.locationsService.getCountries().pipe(T(1)).subscribe(e=>{this.countries=e}),this.assets.getPlainText("tos.txt").pipe(T(1)).subscribe(e=>{this.tos=e}),this.handleCityControl(),this.subscriptions.push(this.windowService.isMobile$.subscribe(e=>{this.navigation.backAction=e?this.onBack.bind(this):null})),this.subscriptions.push(this.next$.pipe(Ct(100)).subscribe(()=>{this.stepper.nextStep()}))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe()),this.navigation.backAction=null,this.next$.complete()}initForm(){this.registrationForm=this.formBuilder.group({userData:this.formBuilder.group({name:new y(null,{validators:[h.required],updateOn:"blur"}),surname:new y(null,{validators:[h.required],updateOn:"blur"}),birthday:new y(null,{validators:[h.required]}),country:new y(null,{validators:h.required}),city:new y(null,{validators:h.required})}),credentials:this.formBuilder.group({email:new y(null,{validators:[h.required,h.email],updateOn:"blur"}),username:new y(null,{validators:[h.required],updateOn:"blur"}),password:new y(null,{validators:[h.required,h.minLength(8),h.pattern(K.passwordPattern)],updateOn:"blur"}),confirmPassword:new y(null,{validators:[h.required,this.validateConfirmPassword.bind(this)],updateOn:"blur"})}),privacyPolicy:this.formBuilder.group({accept:new y(!1,{nonNullable:!0,validators:h.requiredTrue})})}),this.registrationForm.controls.userData.controls.city.disable()}handleCityControl(){this.registrationForm.controls.userData.controls.country.valueChanges.subscribe(e=>{let t=this.registrationForm.controls.userData.controls.city;t.setValue(null),t.markAsUntouched(),t.markAsPristine(),e?(t.enable(),this.getCities()):t.disable()})}next(){this.next$.next()}onBack(e){this.activeStep>0?this.stepper.prevStep():e()}onSubmit(){if(this.activeStep!==this.steps.length-1){this.next();return}this.onRegister()}onRegister(){if(P.forceValidation(this.registrationForm.controls.credentials.controls.confirmPassword),!this.registrationForm.valid){this.onInvalidForm();return}this.submissionLoading=!0,this.error="";let e=$t(H(H({},this.registrationForm.value.userData),this.registrationForm.value.credentials),["confirmPassword"]);this.authentication.register(e,{next:this.onRegisterSuccess.bind(this),error:this.onRegisterError.bind(this)})}onInvalidForm(){P.markAllAsDirty(this.registrationForm),this.registrationForm.get("privacyPolicy")?.invalid&&(this.error="You must accept the privacy policy to continue")}onRegisterSuccess(){this.authentication.emailToVerify=this.registrationForm.get("credentials")?.get("email")?.value??null,this.router.navigate(["auth/verify-email"])}onRegisterError(e){this.submissionLoading=!1,e.error.status>=500?this.showErrorToast("Server error","Please try again later."):e.error.status===409?this.showErrorToast("Conflict","Email or username already in use."):e.error.status>=400?this.showErrorToast("Invalid data","Please check your data and try again."):e.error.status===0?this.showErrorToast("Network error","Check your connection and try again"):this.showErrorToast("An error occurred","Please try again later."),console.error(e.error)}getCities(){let e=this.registrationForm.controls.userData.controls.country;e.valid&&e.value&&(this.cities=[],this.filteredCities=[],this.locationsService.getCities(e.value).subscribe(t=>{this.cities=t}))}completeCountries(e){this.filteredCountries=this.countries.filter(t=>t.name.toLowerCase().includes(e.query.toLowerCase()))??[]}completeCities(e){this.filteredCities=this.cities.filter(t=>t.toLowerCase().includes(e.query.toLowerCase()))}setDialogVisibility(e){(e instanceof MouseEvent||e instanceof KeyboardEvent&&e.key==="Enter")&&(this.privacyPolicyDialogVisible=!0)}validateConfirmPassword(e){let t=this.registrationForm?.get("credentials")?.get("password");return e.value===t?.value?{}:{passwordsDoNotMatch:!0}}showErrorToast(e,t){this.message.add({severity:"error",summary:e,detail:t})}};i.\u0275fac=function(t){return new(t||i)(d(q),d(He),d(ge),d(I),d(E),d(et),d($),d(he))},i.\u0275cmp=O({type:i,selectors:[["dd24-registration-page"]],viewQuery:function(t,n){if(t&1&&Ve(fe,5),t&2){let c;ae(c=se())&&(n.stepper=c.first)}},standalone:!0,features:[F],decls:19,vars:12,consts:[[1,"form-card","dd24-auth-form"],["routerLink","../login",1,"login-link","link"],[1,"google-registration"],["type","standard","size","large","text","continue_with",1,"google-signin-button",3,"width"],["align","center",1,"divider"],[3,"activeStepChange","steps","activeStep"],[1,"registration-form",3,"ngSubmit","formGroup"],["formGroupName","userData",1,"inner-form"],["formGroupName","credentials",1,"inner-form"],["formGroupName","privacyPolicy",1,"inner-form"],[1,"error"],["type","submit",1,"next-btn",3,"label","loading"],["header","Terms of Service","resizable","false","draggable","false","modal","true","dismissableMask","true",1,"privacy-policy-dialog","custom-dialog",3,"visibleChange","visible"],[1,"input"],["for","name"],["controlName","name",3,"errorMessages"],["type","text","pInputText","","formControlName","name","name","name","placeholder","Your name","id","name",1,"p-fluid",3,"pKeyFilter"],["for","surname"],["controlName","surname",3,"errorMessages"],["type","text","pInputText","","formControlName","surname","name","surname","placeholder","Your surname","id","surname",1,"p-fluid",3,"pKeyFilter"],["for","birthday"],["controlName","birthday",3,"errorMessages"],["formControlName","birthday","name","birthday","iconDisplay","input","placeholder","dd/mm/yyyy","dateFormat","dd/mm/yy","inputId","birthday",1,"p-fluid",3,"showIcon","minDate","maxDate","defaultDate"],["for","country"],["controlName","country",3,"errorMessages"],["formControlName","country","name","country","placeholder","The country you live in","emptyMessage","No countries found","optionLabel","name","optionValue","code","forceSelection","true","minLength","2","inputId","country",1,"p-fluid",3,"completeMethod","suggestions","pKeyFilter"],["for","city"],["controlName","city",3,"errorMessages"],["formControlName","city","name","city","placeholder","The city you live in","emptyMessage","No cities found","forceSelection","true","inputId","city","minLength","2",1,"p-fluid",3,"completeMethod","suggestions","pKeyFilter"],["for","email"],["controlName","email",3,"errorMessages"],["type","email","pInputText","","formControlName","email","name","email","placeholder","Your email","id","email","autocomplete","email",1,"p-fluid"],["for","username"],["controlName","username",3,"errorMessages"],["type","text","pInputText","","formControlName","username","name","username","placeholder","An unique username","id","username","pKeyFilter","alphanum","autocomplete","off",1,"p-fluid",3,"maxlength"],["for","password"],["controlName","password",3,"errorMessages"],["type","password","formControlName","password","name","password","toggleMask","true","placeholder","A strong password","inputId","password","autocomplete","new-password",1,"p-fluid",3,"feedback","strongRegex","mediumRegex"],["for","confirm-password"],["controlName","confirmPassword",3,"errorMessages"],["type","password","formControlName","confirmPassword","name","confirm-password","toggleMask","true","placeholder","The same as above","inputId","confirm-password",1,"p-fluid",3,"feedback"],["tabindex","0",1,"privacy-policy-preview",3,"click","keypress"],[1,"privacy-policy-preview-mask"],[1,"privacy-policy-preview-top"],[1,"pi","pi-arrow-right"],[1,"privacy-policy-checkbox-container"],["formControlName","accept","inputId","accept","binary","true",1,"privacy-policy-checkbox"],["for","accept"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"h1"),u(2,"Sign up to DietiDeals24"),s(),a(3,"a",1),u(4," already have an account? "),s(),a(5,"div",2),g(6,"asl-google-signin-button",3),s(),a(7,"p-divider",4),u(8,"or"),s(),a(9,"dd24-stepper",5),me("activeStepChange",function(p){return ce(n.activeStep,p)||(n.activeStep=p),p}),s(),a(10,"form",6),_("ngSubmit",function(){return n.onSubmit()}),x(11,Gi,26,34,"div",7)(12,Ki,21,29,"div",8)(13,Wi,13,1,"div",9)(14,Yi,2,1,"span",10),g(15,"p-button",11),s(),a(16,"p-dialog",12),me("visibleChange",function(p){return ce(n.privacyPolicyDialogVisible,p)||(n.privacyPolicyDialogVisible=p),p}),a(17,"span"),u(18),s()()()),t&2&&(l(6),m("width",300),l(3),m("steps",n.steps),le("activeStep",n.activeStep),l(),m("formGroup",n.registrationForm),l(),M(11,n.activeStep===0?11:-1),l(),M(12,n.activeStep===1?12:-1),l(),M(13,n.activeStep===2?13:-1),l(),M(14,n.error?14:-1),l(),m("label",n.activeStep!==n.steps.length-1?"Next":"Register")("loading",n.submissionLoading),l(),le("visible",n.privacyPolicyDialogVisible),l(2),J(n.tos))},dependencies:[fe,R,N,Y,W,z,U,L,ee,A,V,Be,j,B,je,X,$e,Ye,Ue,qe,We,Ke,ye,ve,Xe,Je,Ge,ze,Ze,Qe,it,tt],styles:[".form-card[_ngcontent-%COMP%]{color:var(--text-color-1)}.form-card[_ngcontent-%COMP%]   .google-registration[_ngcontent-%COMP%]{margin-top:1rem;width:100%;padding-left:3rem;padding-right:3rem;min-height:44px;display:flex;justify-content:center}.form-card[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:100%}.form-card[_ngcontent-%COMP%]   .registration-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:0;flex-wrap:nowrap;padding-left:3rem;padding-right:3rem;width:100%;gap:1rem;font-size:var(--font-size-medium);font-weight:var(--font-weight-normal)}.form-card[_ngcontent-%COMP%]   .registration-form[_ngcontent-%COMP%]   .inner-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:1em;flex-wrap:nowrap}.form-card[_ngcontent-%COMP%]   .inner-form[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:1rem}.form-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .form-card[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{align-self:center;word-wrap:break-word}.form-card[_ngcontent-%COMP%]   .privacy-policy-preview[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:0;flex-wrap:nowrap;border-radius:var(--border-radius-medium);border:var(--border);padding:.5em;font-size:var(--font-size-medium);height:6em;overflow:hidden;color:var(--text-color-2);position:relative;cursor:pointer}.form-card[_ngcontent-%COMP%]   .privacy-policy-preview[_ngcontent-%COMP%]   .privacy-policy-preview-mask[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;height:70%;background:linear-gradient(rgba(255,255,255,0),var(--component-color) 120%)}.form-card[_ngcontent-%COMP%]   .privacy-policy-preview[_ngcontent-%COMP%]   .privacy-policy-preview-top[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:0;flex-wrap:nowrap}.form-card[_ngcontent-%COMP%]   .privacy-policy-preview[_ngcontent-%COMP%]   .privacy-policy-preview-top[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-weight:var(--font-weight-bolder)}.form-card[_ngcontent-%COMP%]   .privacy-policy-checkbox[_ngcontent-%COMP%]{vertical-align:middle;margin-right:1ch}.form-card[_ngcontent-%COMP%]   .privacy-policy-checkbox[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{vertical-align:middle;cursor:pointer}[_nghost-%COMP%]     .p-divider{margin-bottom:0}[_nghost-%COMP%]     .p-divider-content{font-weight:var(--font-weight-bolder);color:var(--text-color-3)}"]});let o=i;return o})();var $i=()=>({validation:"required",message:"an email or username is required"}),Qi=o=>[o];function Zi(o,i){if(o&1){let r=D();a(0,"p"),u(1," We'll send you an email to reset your password and get you back to making deals "),s(),a(2,"form",1),_("ngSubmit",function(){C(r);let t=v();return b(t.onSubmit())}),a(3,"section",2)(4,"div",3)(5,"label",4),u(6,"Enter your email address or username"),s(),a(7,"dd24-input",5),g(8,"input",6),s()()(),g(9,"p-button",7),s()}if(o&2){let r=v();l(2),m("formGroup",r.forgotPasswordForm),l(5),m("errorMessages",w(4,Qi,f(3,$i))),l(2),m("loading",r.submissionLoading)}}function Hi(o,i){o&1&&(a(0,"p"),u(1," We have sent an email to the email address associated to the account. Once you have reset your password, log in and get back to what you were doing by clicking the button below "),s(),g(2,"p-button",8))}var ai=(()=>{let i=class i{constructor(e,t,n){this.formBuilder=e,this.authentication=t,this.message=n,this.submissionLoading=!1,this.submittedSuccessfully=!1}ngOnInit(){this.forgotPasswordForm=this.formBuilder.group({emailOrUsername:new y(null,{updateOn:"blur",validators:[h.required]})})}onSubmit(){if(this.forgotPasswordForm.invalid){P.markAllAsDirty(this.forgotPasswordForm);return}this.submissionLoading=!0,this.authentication.requestForgottenPasswordReset(this.forgotPasswordForm.value.emailOrUsername.includes("@")?{email:this.forgotPasswordForm.value.emailOrUsername}:{username:this.forgotPasswordForm.value.emailOrUsername}).subscribe({next:this.onSubmissionSuccess.bind(this),error:this.onSubmissionError.bind(this)})}onSubmissionSuccess(){this.submissionLoading=!1,this.submittedSuccessfully=!0}onSubmissionError(e){this.submissionLoading=!1,e.error.status>=500?this.displayError("Server error","Please try again later"):e.error.status>=400?this.displayError("Incorrect email or username","Please try again"):e.error.status===0?this.displayError("Network error","Check your connection and try again"):this.displayError("An error occurred","Please try again")}displayError(e,t){this.message.add({severity:"error",summary:e,detail:t})}};i.\u0275fac=function(t){return new(t||i)(d(q),d(I),d(E))},i.\u0275cmp=O({type:i,selectors:[["dd24-forgot-password-page"]],standalone:!0,features:[F],decls:5,vars:1,consts:[[1,"form-card","dd24-auth-form"],[1,"forgot-password-form",3,"ngSubmit","formGroup"],[1,"inputs"],[1,"input"],["for","email-username"],["controlName","emailOrUsername",3,"errorMessages"],["type","text","pInputText","","formControlName","emailOrUsername","name","email-username","id","email-username",1,"p-fluid"],["label","Send","type","submit",1,"forgot-submit",3,"loading"],["label","Login","routerLink","../login",1,"login-btn"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"h1"),u(2,"Reset your password"),s(),x(3,Zi,10,6)(4,Hi,3,0),s()),t&2&&(l(3),M(3,n.submittedSuccessfully?4:3))},dependencies:[z,R,N,U,L,ee,A,V,j,B,Y,W,X],styles:[".form-card[_ngcontent-%COMP%]{gap:1rem}.form-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}.forgot-password-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:2rem;flex-wrap:nowrap;padding-left:3rem;padding-right:3rem;font-size:var(--font-size-medium);width:100%}.forgot-password-form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:1em;flex-wrap:nowrap}.forgot-password-form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:0;flex-wrap:nowrap}.login-btn[_ngcontent-%COMP%]{align-self:stretch}"]});let o=i;return o})();function Ji(o,i){o&1&&g(0,"dd24-logo",4)}function Xi(o,i){o&1&&(a(0,"div",4),g(1,"dd24-logo"),s())}function en(o,i){o&1&&g(0,"div",5)}function tn(o,i){o&1&&g(0,"div",5)}var si=(()=>{let i=class i{constructor(e,t,n,c,p,S,Z){this.navigation=e,this.windowService=t,this.authentication=n,this.socialAuthService=c,this.message=p,this.router=S,this.route=Z,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.socialAuthService.authState.pipe(bt(this.authentication.isLogged$),Fe(([e,t])=>!t),be(([e])=>e)).subscribe(e=>{e&&this.authentication.loginUsingSocials(e).subscribe({next:()=>this.navigation.navigateToRouteBeforeRedirection(),error:t=>this.onSocialLoginError(t,e)})}))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}goBack(){this.navigation.back()}onSocialLoginError(e,t){if(e.error.status===409){this.router.navigate(["login"],{relativeTo:this.route}),this.message.add({severity:"warn",summary:"Log in using credentials",detail:"Please log in using your credentials"});return}if(e.error.status>=500){this.message.add({severity:"error",summary:"Server error",detail:"An error occurred on the server. Please try again later"});return}if(e.error.status===0){this.message.add({severity:"error",summary:"Network error",detail:"Check your connection and try again"});return}this.router.navigate(["social-registration"],{state:{user:t},relativeTo:this.route})}};i.\u0275fac=function(t){return new(t||i)(d($),d(he),d(I),d(Pe),d(E),d(ge),d(pe))},i.\u0275cmp=O({type:i,selectors:[["dd24-authentication-page"]],standalone:!0,features:[F],decls:13,vars:9,consts:[[1,"authentication-page"],[1,"banner"],[1,"page-back-button",3,"click"],["id","arrow-back-button-icon",1,"pi","pi-arrow-left"],[1,"logo"],[1,"spacer"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),_("click",function(){return n.goBack()}),g(3,"i",3),s(),x(4,Ji,1,0,"dd24-logo",4),de(5,"async"),s(),a(6,"main"),x(7,Xi,2,0,"div",4),de(8,"async"),x(9,en,1,0),g(10,"router-outlet"),x(11,tn,1,0,"div",5),de(12,"async"),s()()),t&2&&(l(4),M(4,Le(5,3,n.windowService.isMobile$)===!1?4:-1),l(3),M(7,Le(8,5,n.windowService.isMobile$)?7:9),l(4),M(11,Le(12,7,n.windowService.isMobile$)===!1?11:-1))},dependencies:[Jt,Bt,zt],styles:['.authentication-page[_ngcontent-%COMP%]{height:100dvh;background-color:var(--background-color);width:100%;display:grid;grid-template:"banner main" 1fr/52% 48%;grid-gap:0;justify-items:stretch;align-items:stretch;justify-content:stretch;align-content:stretch}@media (max-width: 768px){.authentication-page[_ngcontent-%COMP%]{grid-template:"main" 1fr/1fr;height:auto;min-height:100%;background-color:var(--component-color)}}.authentication-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{grid-area:banner;background-color:var(--side-color);position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:0;flex-wrap:nowrap;border-right:2px solid var(--border-color-side)}@media (max-width: 768px){.authentication-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{display:none}}.authentication-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .page-back-button[_ngcontent-%COMP%]{--size: 4rem;display:flex;flex-direction:row;justify-content:center;align-items:center;gap:0;flex-wrap:nowrap;position:absolute;top:0;left:0;background-color:transparent;border:none;color:var(--text-side-color);overflow:hidden;padding:calc(var(--size) / 4);cursor:pointer}.authentication-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .page-back-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{height:var(--size);width:var(--size);font-size:var(--size)}@media (max-width: 768px){.authentication-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .page-back-button[_ngcontent-%COMP%]{position:static;--size: 2rem}}.authentication-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:70%}.authentication-page[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{grid-area:main;display:flex;flex-direction:column;justify-content:start;align-items:center;gap:1rem;flex-wrap:nowrap;padding-top:2rem;padding-bottom:2rem;overflow-y:auto;height:100%}.authentication-page[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{align-self:center;display:block;width:75%}.authentication-page[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}@media (max-width: 768px){.authentication-page[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:auto;overflow:hidden;align-items:stretch;justify-content:center;background-color:var(--background-color)}}']});let o=i;return o})();var nn=(o,i,r)=>({$implicit:o,events:i,index:r});function rn(o,i){if(o&1){let r=D();Re(0),a(1,"input",2),_("input",function(t){C(r);let n=v().$implicit,c=v();return b(c.onInput(t,n-1))})("focus",function(t){C(r);let n=v(2);return b(n.onInputFocus(t))})("blur",function(t){C(r);let n=v(2);return b(n.onInputBlur(t))})("paste",function(t){C(r);let n=v(2);return b(n.onPaste(t))})("keydown",function(t){C(r);let n=v(2);return b(n.onKeyDown(t))}),s(),Ae()}if(o&2){let r=v().$implicit,e=v();l(),m("value",e.getModelValue(r))("maxLength",1)("type",e.inputType)("inputmode",e.inputMode)("variant",e.variant)("readonly",e.readonly)("disabled",e.disabled)("invalid",e.invalid)("tabindex",e.tabindex)("unstyled",e.unstyled)("autofocus",e.getAutofocus(r))}}function on(o,i){o&1&&kt(0)}function an(o,i){if(o&1&&(Re(0),x(1,on,1,0,"ng-container",3),Ae()),o&2){let r=v().$implicit,e=v();l(),m("ngTemplateOutlet",e.inputTemplate)("ngTemplateOutletContext",Dt(2,nn,e.getToken(r-1),e.getTemplateEvents(r-1),r))}}function sn(o,i){if(o&1&&(Re(0),x(1,rn,2,11,"ng-container",1)(2,an,2,6,"ng-container",1),Ae()),o&2){let r=v();l(),m("ngIf",!r.inputTemplate),l(),m("ngIf",r.inputTemplate)}}var ln={provide:Qt,useExisting:xt(()=>ht),multi:!0},ht=(()=>{class o{cd;invalid=!1;disabled=!1;readonly=!1;variant="outlined";tabindex=null;length=4;mask=!1;integerOnly=!1;autofocus;onChange=new ne;onFocus=new ne;onBlur=new ne;templates;inputTemplate;tokens=[];onModelChange=()=>{};onModelTouched=()=>{};value;get inputMode(){return this.integerOnly?"numeric":"text"}get inputType(){return this.mask?"password":"text"}constructor(r){this.cd=r}ngAfterContentInit(){this.templates.forEach(r=>{switch(r.getType()){case"input":this.inputTemplate=r.template;break;default:this.inputTemplate=r.template;break}})}getToken(r){return this.tokens[r]}getTemplateEvents(r){return{input:e=>this.onInput(e,r),keydown:e=>this.onKeyDown(e),focus:e=>this.onFocus.emit(e),blur:e=>this.onBlur.emit(e),paste:e=>this.onPaste(e)}}onInput(r,e){this.tokens[e]=r.target.value,this.updateModel(r),r.inputType==="deleteContentBackward"?this.moveToPrev(r):(r.inputType==="insertText"||r.inputType==="deleteContentForward")&&this.moveToNext(r)}updateModel(r){let e=this.tokens.join("");this.onModelChange(e),this.onChange.emit({originalEvent:r,value:e})}writeValue(r){r?Array.isArray(r)&&r.length>0?this.value=r.slice(0,this.length):this.value=r.toString().split("").slice(0,this.length):this.value=r,this.updateTokens(),this.cd.markForCheck()}updateTokens(){this.value!==null&&this.value!==void 0?Array.isArray(this.value)?this.tokens=[...this.value]:this.tokens=this.value.toString().split(""):this.tokens=[]}getModelValue(r){return this.tokens[r-1]||""}getAutofocus(r){return r===1?this.autofocus:!1}registerOnChange(r){this.onModelChange=r}registerOnTouched(r){this.onModelTouched=r}moveToPrev(r){let e=this.findPrevInput(r.target);e&&(e.focus(),e.select())}moveToNext(r){let e=this.findNextInput(r.target);e&&(e.focus(),e.select())}findNextInput(r){let e=r.nextElementSibling;if(e)return e.nodeName==="INPUT"?e:this.findNextInput(e)}findPrevInput(r){let e=r.previousElementSibling;if(e)return e.nodeName==="INPUT"?e:this.findPrevInput(e)}onInputFocus(r){r.target.select(),this.onFocus.emit(r)}onInputBlur(r){this.onBlur.emit(r)}onKeyDown(r){switch(r.code){case"ArrowLeft":this.moveToPrev(r),r.preventDefault();break;case"ArrowUp":case"ArrowDown":r.preventDefault();break;case"Backspace":r.target.value.length===0&&(this.moveToPrev(r),r.preventDefault());break;case"ArrowRight":this.moveToNext(r),r.preventDefault();break;default:(this.integerOnly&&!((r.code.startsWith("Digit")||r.code.startsWith("Numpad"))&&Number(r.key)>=0&&Number(r.key)<=9)||this.tokens.join("").length>=this.length&&r.code!=="Delete")&&r.preventDefault();break}}onPaste(r){let e=r.clipboardData.getData("text");if(e.length){let t=e.substring(0,this.length+1);(!this.integerOnly||!isNaN(t))&&(this.tokens=t.split(""),this.updateModel(r))}r.preventDefault()}getRange(r){return Array.from({length:r},(e,t)=>t+1)}trackByFn(r){return r}static \u0275fac=function(e){return new(e||o)(d(Rt))};static \u0275cmp=O({type:o,selectors:[["p-inputOtp"]],contentQueries:function(e,t,n){if(e&1&&Ft(n,Kt,4),e&2){let c;ae(c=se())&&(t.templates=c)}},hostAttrs:[1,"p-inputotp","p-component"],inputs:{invalid:"invalid",disabled:"disabled",readonly:"readonly",variant:"variant",tabindex:"tabindex",length:"length",mask:"mask",integerOnly:"integerOnly",autofocus:[Pt.HasDecoratorInputTransform,"autofocus","autofocus",At]},outputs:{onChange:"onChange",onFocus:"onFocus",onBlur:"onBlur"},features:[Tt([ln]),Mt],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["type","text","pInputText","","pAutoFocus","",1,"p-inputotp-input",3,"input","focus","blur","paste","keydown","value","maxLength","type","inputmode","variant","readonly","disabled","invalid","tabindex","unstyled","autofocus"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,t){e&1&&x(0,sn,3,2,"ng-container",0),e&2&&m("ngForOf",t.getRange(t.length))("ngForTrackBy",t.trackByFn)},dependencies:[Vt,Lt,jt,W,Wt],encapsulation:2,changeDetection:0})}return o})(),li=(()=>{class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=ie({type:o});static \u0275inj=te({imports:[ue,dt,Y,Yt,dt]})}return o})();var mn=()=>({validation:"required",message:"a code is required"}),dn=()=>["minlength","maxlength"],un=o=>({validation:o,message:"the code must be 5 digits long"}),pn=(o,i)=>[o,i],ci=(()=>{let i=class i{constructor(e,t,n,c){this.authentication=e,this.formBuilder=t,this.navigation=n,this.message=c,this.showEmail=!1,this.submissionLoading=!1}ngOnInit(){if(!this.authentication.emailToVerify){this.navigation.back();return}this.verificationForm=this.formBuilder.group({code:new y("",{validators:[h.required,h.minLength(5),h.maxLength(5)],updateOn:"submit"}),email:new y(this.authentication.emailToVerify,[h.required])})}toggleEmailVisibility(){this.showEmail=!this.showEmail}onSubmit(){if(this.verificationForm.invalid){this.onInvalidForm();return}this.submissionLoading=!0,this.authentication.verifyEmail(this.verificationForm.value,{next:this.onVerificationSuccess.bind(this),error:this.onVerificationError.bind(this)})}onKeyPressed(e){e.key==="Enter"&&this.onSubmit()}onInvalidForm(){P.markAllAsDirty(this.verificationForm)}onVerificationSuccess(){this.navigation.navigateToRouteBeforeRedirection()}onVerificationError(e){this.submissionLoading=!1,e.error.status>=500?this.displayError("Server error","Please try again later."):e.error.status>=400?this.displayError("Invalid code","Please check your code and try again."):e.error.status===0?this.displayError("Network error","Check your connection and try again"):this.displayError("An error occurred","Please try again later")}displayError(e,t){this.message.add({severity:"error",summary:e,detail:t})}};i.\u0275fac=function(t){return new(t||i)(d(I),d(q),d($),d(E))},i.\u0275cmp=O({type:i,selectors:[["dd24-verify-email-page"]],standalone:!0,features:[F],decls:18,vars:18,consts:[[1,"form-card","dd24-auth-form"],["tabindex","0",1,"verification-form",3,"ngSubmit","keypress","formGroup"],[1,"input","code-input"],["controlName","code",3,"errorMessages"],["formControlName","code",3,"integerOnly","length"],[1,"address-box-container"],[1,"address-box"],[1,"email-mask-toggle",3,"click"],["label","verify","type","submit",1,"submit-btn",3,"loading"]],template:function(t,n){if(t&1&&(a(0,"div",0)(1,"h1"),u(2,"Verify your email address"),s(),a(3,"form",1),_("ngSubmit",function(){return n.onSubmit()})("keypress",function(p){return n.onKeyPressed(p)}),a(4,"p"),u(5," We have sent an email to the selected address containing a code for verification. "),s(),a(6,"div",2)(7,"dd24-input",3),g(8,"p-inputOtp",4),s()(),a(9,"div",5)(10,"p"),u(11,"The address we sent the email to is:"),s(),a(12,"span",6),u(13),de(14,"masked"),a(15,"button",7),_("click",function(){return n.toggleEmailVisibility()}),g(16,"i"),s()()(),g(17,"p-button",8),s()()),t&2){let c;l(3),m("formGroup",n.verificationForm),l(4),m("errorMessages",k(15,pn,f(11,mn),w(13,un,f(12,dn)))),l(),m("integerOnly",!0)("length",5),l(5),Et(" ",n.showEmail?(c=(c=n.verificationForm.get("email"))==null?null:c.value)!==null&&c!==void 0?c:"":Nt(14,8,(c=(c=n.verificationForm.get("email"))==null?null:c.value)!==null&&c!==void 0?c:"","email")," "),l(3),It(n.showEmail?"pi pi-eye-slash":"pi pi-eye"),l(),m("loading",n.submissionLoading)}},dependencies:[U,L,A,V,j,B,li,ht,R,N,z,Xt],styles:[".form-card[_ngcontent-%COMP%]{color:var(--text-color-1)}.form-card[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:0;flex-wrap:nowrap;padding-left:2.5rem;padding-right:2.5rem;margin:1rem 0;width:100%;gap:1rem;font-size:var(--font-size-medium);font-weight:var(--font-weight-normal)}.form-card[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{align-self:center}.form-card[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   .address-box-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:center;gap:0;flex-wrap:nowrap}.form-card[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   .address-box-container[_ngcontent-%COMP%]   .address-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start;align-items:center;gap:1ch;flex-wrap:nowrap;color:var(--text-color-2)}.form-card[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   .address-box-container[_ngcontent-%COMP%]   .email-mask-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;color:var(--basic-affordances-color)}[_nghost-%COMP%]     .p-inputotp-input{padding:.8rem .75rem}"]});let o=i;return o})();var ft=(()=>{let i=class i{constructor(e){this.authenticationService=e}canActivate(){return!!this.authenticationService.emailToVerify}canDeactivate(){return this.authenticationService.emailToVerify=null,!0}static asCanActivateFn(){return i.emailVerificationActivateFnGuard}static asCanDeactivateFn(){return i.emailVerificationDeactivateFnGuard}};i.emailVerificationActivateFnGuard=()=>xe(i).canActivate(),i.emailVerificationDeactivateFnGuard=()=>xe(i).canDeactivate(),i.\u0275fac=function(t){return new(t||i)(Q(I))},i.\u0275prov=oe({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var gn=()=>({validation:"required",message:"a password is required"}),hn=()=>["pattern","minlength","maxlength"],fn=o=>({validation:o,message:"a password must be at least 8 characters long, and contain at least one lowercase letter, one uppercase letter, and one special character."}),mi=(o,i)=>[o,i],vn=()=>({validation:"required",message:"you need to confirm your password"}),yn=()=>({customValidation:"passwordsDoNotMatch",message:"passwords do not match"});function _n(o,i){if(o&1){let r=D();a(0,"form",2),_("ngSubmit",function(){C(r);let t=v();return b(t.onSubmit())}),a(1,"section",3)(2,"div",4)(3,"label",5),u(4,"New password*"),s(),a(5,"dd24-input",6),g(6,"p-password",7),s()(),a(7,"div",4)(8,"label",8),u(9," Confirm new password* "),s(),a(10,"dd24-input",9),g(11,"p-password",10),s()()(),g(12,"p-button",11),s()}if(o&2){let r=v();m("formGroup",r.resetPasswordForm),l(5),m("errorMessages",k(12,mi,f(8,gn),w(10,fn,f(9,hn)))),l(),m("feedback",!0)("strongRegex",r.environment.passwordStrongPattern)("mediumRegex",r.environment.passwordMediumPattern),l(4),m("errorMessages",k(17,mi,f(15,vn),f(16,yn))),l(),m("feedback",!1),l(),m("loading",r.submissionLoading)}}function wn(o,i){o&1&&(a(0,"p"),u(1,"You can log in to your account"),s(),g(2,"p-button",12))}var di=(()=>{let i=class i{constructor(e,t,n,c){this.route=e,this.formBuilder=t,this.authentication=n,this.message=c,this.resettedSuccessfully=!1,this.submissionLoading=!1,this.environment=K}ngOnInit(){this.route.params.pipe(T(1)).subscribe(e=>{this.id=e.id,this.token=e.token}),this.resetPasswordForm=this.formBuilder.group({newPassword:new y(null,{validators:[h.required,h.minLength(8),h.pattern(K.passwordPattern)],updateOn:"blur"}),confirmNewPassword:new y(null,{validators:[h.required,this.validateConfirmPassword.bind(this)],updateOn:"blur"})})}onSubmit(){if(P.forceValidation(this.resetPasswordForm.controls.confirmNewPassword),this.resetPasswordForm.invalid){P.markAllAsDirty(this.resetPasswordForm);return}this.submissionLoading=!0,this.authentication.resetForgottenPassword({userId:this.id,token:this.token,newPassword:this.resetPasswordForm.value.newPassword}).subscribe({next:this.onSubmissionSuccess.bind(this),error:this.onSubmissionError.bind(this)})}onSubmissionSuccess(){this.submissionLoading=!1,this.resettedSuccessfully=!0}onSubmissionError(e){this.submissionLoading=!1,e.error.status>=500?this.displayError("Server error","Please try again later"):e.error.status>=400?this.displayError("Invalid submission","Paste the url you received and try again"):e.error.status===0?this.displayError("Network error","Check your connection and try again"):this.displayError("An error occurred","Please try again")}displayError(e,t){this.message.add({severity:"error",summary:e,detail:t})}validateConfirmPassword(e){return e.value===this.resetPasswordForm?.controls.newPassword.value?{}:{passwordsDoNotMatch:!0}}};i.\u0275fac=function(t){return new(t||i)(d(pe),d(q),d(I),d(E))},i.\u0275cmp=O({type:i,selectors:[["dd24-reset-password-page"]],standalone:!0,features:[F],decls:5,vars:1,consts:[[1,"form-card","dd24-auth-form"],[1,"reset-password-form",3,"formGroup"],[1,"reset-password-form",3,"ngSubmit","formGroup"],[1,"inputs"],[1,"input"],["for","new-password"],["controlName","newPassword",3,"errorMessages"],["type","password","formControlName","newPassword","name","new-password","toggleMask","true","placeholder","A strong password","inputId","new-password","autocomplete","new-password",1,"p-fluid",3,"feedback","strongRegex","mediumRegex"],["for","confirm-new-password"],["controlName","confirmNewPassword",3,"errorMessages"],["type","password","formControlName","confirmNewPassword","name","confirm-new-password","toggleMask","true","placeholder","The same as above","inputId","confirm-new-password","autocomplete","new-password",1,"p-fluid",3,"feedback"],["label","Reset","type","submit",1,"reset-submit",3,"loading"],["label","Login","routerLink","/auth/login",1,"login-btn"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"h1"),u(2,"Reset your password"),s(),x(3,_n,13,20,"form",1)(4,wn,3,0),s()),t&2&&(l(3),M(3,n.resettedSuccessfully?4:3))},dependencies:[R,N,U,L,A,V,j,B,z,ye,ve,X],styles:[".form-card[_ngcontent-%COMP%]{gap:1rem}.form-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}.reset-password-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:2rem;flex-wrap:nowrap;padding-left:3rem;padding-right:3rem;font-size:var(--font-size-medium);width:100%}.reset-password-form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:1em;flex-wrap:nowrap}.reset-password-form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;gap:0;flex-wrap:nowrap}.login-btn[_ngcontent-%COMP%]{align-self:stretch}"]});let o=i;return o})();var Cn=()=>({validation:"required",message:"an username is required"}),Ie=o=>[o],bn=()=>({validation:"required",message:"a name is required"}),xn=()=>({validation:"required",message:"a surname is required"}),Pn=()=>({validation:"required",message:"a birthday is required"}),Sn=()=>({validation:"required",message:"a country is required"}),On=()=>({customValidation:"noCountrySelected",message:"You must select a country before selecting a city"}),Mn=()=>({validation:"required",message:"a city is required"}),In=(o,i)=>[o,i];function kn(o,i){if(o&1){let r=D();a(0,"div",4)(1,"div",8)(2,"label",9),u(3,"Username*"),s(),a(4,"dd24-input",10),g(5,"input",11),s()(),a(6,"div",8)(7,"label",12),u(8,"Name*"),s(),a(9,"dd24-input",13),g(10,"input",14),s()(),a(11,"div",8)(12,"label",15),u(13,"Surname*"),s(),a(14,"dd24-input",16),g(15,"input",17),s()(),a(16,"div",8)(17,"label",18),u(18,"Birthday*"),s(),a(19,"dd24-input",19),g(20,"p-calendar",20),s()(),a(21,"div",8)(22,"label",21),u(23,"Country*"),s(),a(24,"dd24-input",22)(25,"p-autoComplete",23),_("completeMethod",function(t){C(r);let n=v();return b(n.completeCountries(t))}),s()()(),a(26,"div",8)(27,"label",24),u(28,"City*"),s(),a(29,"dd24-input",25)(30,"p-autoComplete",26),_("completeMethod",function(t){C(r);let n=v();return b(n.completeCities(t))}),s()()()()}if(o&2){let r=v();l(4),m("errorMessages",w(20,Ie,f(19,Cn))),l(),m("maxlength",r.environment.usernameMaxLength),l(4),m("errorMessages",w(23,Ie,f(22,bn))),l(),m("pKeyFilter",r.environment.alphaAndWhiteSpacePattern),l(4),m("errorMessages",w(26,Ie,f(25,xn))),l(),m("pKeyFilter",r.environment.alphaAndWhiteSpacePattern),l(4),m("errorMessages",w(29,Ie,f(28,Pn))),l(),m("showIcon",!0)("minDate",r.minBirthdayDate)("maxDate",r.maxBirthdayDate)("defaultDate",r.defaultBirthdayDate),l(4),m("errorMessages",w(32,Ie,f(31,Sn))),l(),m("suggestions",r.filteredCountries)("pKeyFilter",r.environment.alphaAndWhiteSpacePattern),l(2),Ne("p-disabled",r.socialRegistrationForm.controls.userData.controls.city.disabled),l(2),m("errorMessages",k(36,In,f(34,On),f(35,Mn))),l(),m("suggestions",r.filteredCities)("pKeyFilter",r.environment.alphaAndWhiteSpacePattern)}}function Fn(o,i){if(o&1){let r=D();a(0,"div",27)(1,"div",28),_("click",function(){C(r);let t=v();return b(t.privacyPolicyDialogVisible=!0)})("keyup.enter",function(){C(r);let t=v();return b(t.privacyPolicyDialogVisible=!0)}),g(2,"div",29),a(3,"div",30)(4,"span"),u(5,"Terms of Service"),s(),g(6,"i",31),s(),a(7,"span"),u(8),s()(),a(9,"div",32),g(10,"p-checkbox",33),a(11,"label",34),u(12,"I have read and accept the terms of the above terms of service"),s()()()}if(o&2){let r=v();l(8),J(r.tos)}}function En(o,i){if(o&1&&(a(0,"span",5),u(1),s()),o&2){let r=v();l(),J(r.error)}}var ui=(()=>{let i=class i{constructor(e,t,n,c,p,S,Z,Ce,gi,hi){this.route=e,this.http=t,this.formBuilder=n,this.locationsService=c,this.upload=p,this.authentication=S,this.navigation=Z,this.message=Ce,this.windowService=gi,this.assets=hi,this.subscriptions=[],this.submissionLoading=!1,this.activeStep=0,this.error="",this.environment=K,this.countries=[],this.filteredCountries=[],this.cities=[],this.filteredCities=[],this.minBirthdayDate=new Date(1900,0,1),this.maxBirthdayDate=new Date,this.defaultBirthdayDate=new Date(2e3,0,1),this.onNextuserData=()=>this.socialRegistrationForm.controls.userData.valid?!0:(P.markAllAsDirty(this.socialRegistrationForm.controls.userData),!1),this.steps=[{title:"Your data",nextCallback:this.onNextuserData.bind(this)},{title:"Privacy policy"}],this.privacyPolicyDialogVisible=!1,this.tos=""}ngOnInit(){this.route.data.pipe(T(1)).subscribe(e=>{this.user=e.user,this.initForm(),this.handleCityControl()}),this.maxBirthdayDate.setFullYear(this.maxBirthdayDate.getFullYear()-18),this.locationsService.getCountries().pipe(T(1)).subscribe(e=>{this.countries=e}),this.subscriptions.push(this.windowService.isMobile$.subscribe(e=>{this.navigation.backAction=e?this.onBack.bind(this):null})),this.assets.getPlainText("tos.txt").pipe(T(1)).subscribe(e=>{this.tos=e})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe()),this.navigation.backAction=null}next(){this.stepper.nextStep()}onBack(e){this.activeStep>0?this.stepper.prevStep():e()}onSubmit(){if(this.activeStep!==this.steps.length-1){this.next();return}this.onRegister()}onRegister(){if(!this.socialRegistrationForm.valid){P.markAllAsDirty(this.socialRegistrationForm),this.error="You must accept the privacy policy to continue";return}this.submissionLoading=!0,this.authentication.registerUsingSocials(H({socialUser:this.user},this.socialRegistrationForm.controls.userData.value)).pipe(Ee(()=>this.uploadUserPicture()),Ee(e=>e?this.authentication.editUser({profilePictureUrl:e}).pipe(ct(()=>ke(null))):ke(null))).subscribe({next:()=>this.onRegistrationSuccess(),error:e=>this.onRegistrationError(e)})}onRegistrationSuccess(){this.submissionLoading=!1,this.navigation.navigateToRouteBeforeRedirection()}onRegistrationError(e){this.submissionLoading=!1,e.error.status>500?this.message.add({severity:"error",summary:"Server error",detail:"An error occurred on the server. Please try again later"}):e.error.status===0?this.message.add({severity:"error",summary:"Network error",detail:"Check your connection and try again"}):e.error.status===409?this.message.add({severity:"error",summary:"Usernames already in use",detail:"Please try again"}):this.message.add({severity:"error",summary:"An error occurred",detail:"Please try again"})}initForm(){this.socialRegistrationForm=this.formBuilder.group({userData:this.formBuilder.group({username:new y(null,{validators:[h.required],updateOn:"blur"}),name:new y(this.user.firstName??null,{validators:[h.required],updateOn:"blur"}),surname:new y(this.user.lastName??null,{validators:[h.required],updateOn:"blur"}),birthday:new y(null,{validators:[h.required]}),country:new y(null,{validators:h.required}),city:new y(null,{validators:h.required})}),privacyPolicy:this.formBuilder.group({accept:new y(!1,{validators:[h.requiredTrue],nonNullable:!0})})}),this.socialRegistrationForm.controls.userData.controls.city.disable()}uploadUserPicture(){return this.http.get(this.user.photoUrl,{responseType:"blob",context:new qt().set(Zt,!1)}).pipe(be(e=>{let t=`${this.user.id}.${e.type.split("/")[1]}`;return new File([e],t,{type:e.type})}),Ee(e=>this.upload.upload(e)),be(e=>e.url),ct(()=>ke(null)),T(1))}handleCityControl(){this.socialRegistrationForm.controls.userData.controls.country.valueChanges.subscribe(e=>{let t=this.socialRegistrationForm.controls.userData.controls.city;t.setValue(null),t.markAsUntouched(),t.markAsPristine(),e?(t.enable(),this.getCities()):t.disable()})}getCities(){let e=this.socialRegistrationForm.controls.userData.controls.country;e.valid&&e.value&&(this.cities=[],this.filteredCities=[],this.locationsService.getCities(e.value).subscribe(t=>{this.cities=t}))}completeCountries(e){this.filteredCountries=this.countries.filter(t=>t.name.toLowerCase().includes(e.query.toLowerCase()))??[]}completeCities(e){this.filteredCities=this.cities.filter(t=>t.toLowerCase().includes(e.query.toLowerCase()))}};i.\u0275fac=function(t){return new(t||i)(d(pe),d(Ut),d(q),d(He),d(Ht),d(I),d($),d(E),d(he),d(et))},i.\u0275cmp=O({type:i,selectors:[["dd24-social-registration-page"]],viewQuery:function(t,n){if(t&1&&Ve(fe,5),t&2){let c;ae(c=se())&&(n.stepper=c.first)}},standalone:!0,features:[F],decls:12,vars:9,consts:[[1,"form-card","dd24-auth-form"],[1,"form-header"],[1,"stepper",3,"activeStepChange","steps","activeStep"],[1,"registration-form",3,"ngSubmit","formGroup"],["formGroupName","userData",1,"inner-form"],[1,"error"],["type","submit",1,"next-btn",3,"label","loading"],["header","Terms of Service","resizable","false","draggable","false","modal","true","dismissableMask","true",1,"privacy-policy-dialog","custom-dialog",3,"visibleChange","visible"],[1,"input"],["for","username"],["controlName","username",3,"errorMessages"],["type","text","pInputText","","formControlName","username","name","username","placeholder","An unique username","id","username","pKeyFilter","alphanum","autocomplete","off",1,"p-fluid",3,"maxlength"],["for","name"],["controlName","name",3,"errorMessages"],["type","text","pInputText","","formControlName","name","name","name","placeholder","Your name","id","name",1,"p-fluid",3,"pKeyFilter"],["for","surname"],["controlName","surname",3,"errorMessages"],["type","text","pInputText","","formControlName","surname","name","surname","placeholder","Your surname","id","surname",1,"p-fluid",3,"pKeyFilter"],["for","birthday"],["controlName","birthday",3,"errorMessages"],["formControlName","birthday","name","birthday","iconDisplay","input","placeholder","dd/mm/yyyy","dateFormat","dd/mm/yy","inputId","birthday",1,"p-fluid",3,"showIcon","minDate","maxDate","defaultDate"],["for","country"],["controlName","country",3,"errorMessages"],["formControlName","country","name","country","placeholder","The country you live in","emptyMessage","No countries found","optionLabel","name","optionValue","code","forceSelection","true","minLength","2","inputId","country",1,"p-fluid",3,"completeMethod","suggestions","pKeyFilter"],["for","city"],["controlName","city",3,"errorMessages"],["formControlName","city","name","city","placeholder","The city you live in","emptyMessage","No cities found","forceSelection","true","inputId","city","minLength","2",1,"p-fluid",3,"completeMethod","suggestions","pKeyFilter"],["formGroupName","privacyPolicy",1,"inner-form"],["tabindex","0",1,"privacy-policy-preview",3,"click","keyup.enter"],[1,"privacy-policy-preview-mask"],[1,"privacy-policy-preview-top"],[1,"pi","pi-arrow-right"],[1,"privacy-policy-checkbox-container"],["formControlName","accept","inputId","accept","binary","true",1,"privacy-policy-checkbox"],["for","accept"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"h1",1),u(2,"Complete your registration"),s(),a(3,"dd24-stepper",2),me("activeStepChange",function(p){return ce(n.activeStep,p)||(n.activeStep=p),p}),s(),a(4,"form",3),_("ngSubmit",function(){return n.onSubmit()}),x(5,kn,31,39,"div",4)(6,Fn,13,1)(7,En,2,1,"span",5),g(8,"p-button",6),s(),a(9,"p-dialog",7),me("visibleChange",function(p){return ce(n.privacyPolicyDialogVisible,p)||(n.privacyPolicyDialogVisible=p),p}),a(10,"span"),u(11),s()()()),t&2&&(l(3),m("steps",n.steps),le("activeStep",n.activeStep),l(),m("formGroup",n.socialRegistrationForm),l(),M(5,n.activeStep===0?5:6),l(2),M(7,n.error?7:-1),l(),m("label",n.activeStep!==n.steps.length-1?"Next":"Register")("loading",n.submissionLoading),l(),le("visible",n.privacyPolicyDialogVisible),l(2),J(n.tos))},dependencies:[R,N,Y,W,We,Ke,Ze,Qe,z,$e,Ye,U,L,ee,A,V,Be,j,B,je,fe,Xe,Je,Ge,ze],styles:[".form-card[_ngcontent-%COMP%]{color:var(--text-color-1)}.form-card[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]{text-align:center}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]   .stepper[_ngcontent-%COMP%]{align-self:center;width:80%}}.form-card[_ngcontent-%COMP%]   .registration-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:0;flex-wrap:nowrap;padding-left:3rem;padding-right:3rem;width:100%;gap:1rem;font-size:var(--font-size-medium);font-weight:var(--font-weight-normal)}.form-card[_ngcontent-%COMP%]   .registration-form[_ngcontent-%COMP%]   .inner-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:1em;flex-wrap:nowrap}.form-card[_ngcontent-%COMP%]   .inner-form[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:1rem}.privacy-policy-preview[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:start;align-items:stretch;gap:0;flex-wrap:nowrap;border-radius:var(--border-radius-medium);border:var(--border);padding:.5em;font-size:var(--font-size-medium);height:6em;overflow:hidden;color:var(--text-color-2);position:relative;cursor:pointer}.privacy-policy-preview[_ngcontent-%COMP%]   .privacy-policy-preview-mask[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;height:70%;background:linear-gradient(rgba(255,255,255,0),var(--component-color) 120%)}.privacy-policy-preview[_ngcontent-%COMP%]   .privacy-policy-preview-top[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:0;flex-wrap:nowrap}.privacy-policy-preview[_ngcontent-%COMP%]   .privacy-policy-preview-top[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-weight:var(--font-weight-bolder)}.privacy-policy-checkbox[_ngcontent-%COMP%]{vertical-align:middle;margin-right:1ch}.privacy-policy-checkbox[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{vertical-align:middle;cursor:pointer}"]});let o=i;return o})();var pi=(()=>{let i=class i{constructor(e){this.router=e}resolve(){let e=this.router.getCurrentNavigation()?.extras?.state?.user;if(!e)throw new Error("User not found");return e}static asResolveFn(){return()=>xe(i).resolve()}};i.\u0275fac=function(t){return new(t||i)(Q(ge))},i.\u0275prov=oe({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var Tn=[{path:"",component:si,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",title:"Login",component:ni},{path:"register",title:"Sign Up",component:oi},{path:"social-registration",title:"Complete Your Registration",component:ui,resolve:{user:pi.asResolveFn()}},{path:"forgot-password",title:"Forgot Password",component:ai},{path:"reset-password/:id/:token",title:"Reset Password",component:di},{path:"verify-email",title:"Verify Email",component:ci,canActivate:[ft.asCanActivateFn()],canDeactivate:[ft.asCanDeactivateFn()]}]}],Qo=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ie({type:i}),i.\u0275inj=te({providers:[{provide:"SocialAuthServiceConfig",useValue:{autoLogin:!1,lang:"en",providers:[{id:_e.PROVIDER_ID,provider:new _e("204255150104-09laqhd05kocqpg8ngc1ujoaqi75af4v.apps.googleusercontent.com",{prompt:"none"})}],onError:e=>{console.error(e)}}}],imports:[ue,Gt.forChild(Tn),ei]});let o=i;return o})();export{Qo as AuthenticationModule};
