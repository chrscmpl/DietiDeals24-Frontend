<div class="notifications-menu-wrapper">
    <i
        class="pi pi-inbox"
        pBadge
        [value]="notificationsService.unreadNotificationsCount"
        (click)="toggle($event)"
        (keypress)="onKeyPress($event)"
        tabindex="0"
    ></i>
    <p-overlayPanel
        #panel
        class="notification-panel"
        [style]="{ color: 'var(--text-color-1)' }"
        styleClass="p-overlaypanel-no-padding"
    >
        <div class="notifications-header-wrapper">
            <h3 class="notifications-header">Notifications</h3>
        </div>
        @if (notificationsService.notifications.length) {
            <div class="notifications-menu-nav">
                <p-button
                    severity="secondary"
                    class="notifications-menu-button"
                    (click)="notificationsService.markAllAsRead()"
                    [style]="{ padding: '0.2rem' }"
                >
                    Mark all as read
                </p-button>
                <p-button
                    severity="secondary"
                    class="notifications-menu-button"
                    (click)="notificationsService.deleteAll()"
                    [style]="{ padding: '0.2rem' }"
                >
                    Clear all
                </p-button>
            </div>
        }
        <div
            class="notification-list"
            #notificationList
            [class.empty]="!notificationsService.notifications.length"
            dd24ScrolledToBottomListener
            (scrolledToBottom)="more()"
        >
            @for (
                notification of notificationsService.notifications;
                track notification.id
            ) {
                <dd24-notification
                    class="notification-list-entry"
                    [class.unread]="!notification.read"
                    [notification]="notification"
                    (deleted)="deleteNotification(notification)"
                    (read)="onRead(notification)"
                ></dd24-notification>
            } @empty {
                <p class="notification-empty-message">No notifications</p>
            }
            @if (loadingIndicator.isLoading$ | async) {
                <p-progressSpinner
                    class="loading-spinner"
                    [style]="{ height: '2rem', width: '2rem' }"
                    strokeWidth="4"
                ></p-progressSpinner>
            }
        </div>
    </p-overlayPanel>
</div>
